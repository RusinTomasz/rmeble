class MobileMenu {
  constructor(e, t, i) {
    (this.originalMenu = document.querySelector(e)),
      (this.mobileMenu = this.cloneMenu(this.originalMenu)),
      i &&
        ((this.originalSwitcher = document.querySelector(i)),
        (this.mobileSwitcher = this.cloneMenu(this.originalSwitcher))),
      this.renderClonedMenu(),
      t && this.addLogo();
  }
  cloneMenu(e) {
    return e.cloneNode(!0);
  }
  renderClonedMenu() {
    const e = document.querySelector("body");
    this.mobileMenu.classList.add("mobile-nav");
    const t = this.createHtmlElement("div", "nav-hamburger"),
      i = this.createHtmlElement("div", "burger-inner"),
      n = this.createHtmlElement("span", "topbar"),
      o = this.createHtmlElement("span", "btmbar");
    (i.innerHTML += n.outerHTML + o.outerHTML),
      t.appendChild(i),
      this.mobileMenu.insertBefore(t, this.mobileMenu.firstChild),
      this.mobileSwitcher && this.mobileMenu.appendChild(this.mobileSwitcher),
      e.insertBefore(this.mobileMenu, e.firstChild),
      this.addArrowToExpandedItem(),
      this.signNavButtons();
  }
  addArrowToExpandedItem() {
    document
      .querySelectorAll(".mobile-nav .menu-item--expanded")
      .forEach((e) => {
        const t = this.createHtmlElement("div", "nav-btt"),
          i = this.createHtmlElement("div", "nav-inner");
        t.appendChild(i);
        const n = e.children[0];
        n.parentNode.insertBefore(t, n.nextSibling);
      });
  }
  createHtmlElement(e, t) {
    const i = document.createElement(e);
    return i.classList.add(t), i;
  }
  signNavButtons() {
    const e = document.querySelectorAll(".nav-btt");
    document.querySelector(".nav-hamburger").addEventListener("click", () => {
      if (this.mobileMenu.classList.contains("active")) {
        document.querySelectorAll(".menu.active").forEach(function (e) {
          (e.style.maxHeight = "0px"), e.classList.remove("active");
        });
      }
      this.mobileMenu.classList.toggle("active");
    }),
      e.forEach(function (e) {
        e.addEventListener("click", () => {
          const t = e.nextElementSibling,
            i = e.parentNode.parentNode;
          t.classList.contains("active")
            ? (t.classList.remove("active"), (t.style.maxHeight = "0px"))
            : (t.classList.add("active"),
              (t.style.maxHeight = t.scrollHeight + "px"),
              (i.style.maxHeight = t.scrollHeight + i.scrollHeight + "px"));
        });
      });
  }
  addLogo() {
    const e = this.createHtmlElement("a", "mobile-logo"),
      t = document.querySelector(".nav-hamburger");
    e.setAttribute("href", "/"), t.parentNode.insertBefore(e, t);
  }
}
